<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ²–ç¹©è‡ªé§•è¡Œç¨‹ - è¼•ç°¡ç‰ˆ</title>
    <!-- PWA ç›¸é—œè¨­å®š - START -->
    <link rel="manifest" href="./manifest.json"> <!-- æŒ‡å‘ manifest æª”æ¡ˆ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="theme-color" content="#0077c2">
    <!-- PWA ç›¸é—œè¨­å®š - END -->
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* æ—¥å¼æ¥µç°¡ï¼šä¹¾æ·¨ã€ç•™ç™½ã€æŸ”å’Œçš„é™°å½± */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f8fa; /* éå¸¸æ·ºçš„ç°è‰²èƒŒæ™¯ */
        }
        .app-shell {
            max-width: 640px; /* æ¨¡æ“¬æ‰‹æ©Ÿé‚Šç•Œ */
            margin: 0 auto;
            min-height: 100vh;
            background-color: white;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05); /* è¼•æŸ”çš„é‚Šç•Œé™°å½± */
        }
        .card {
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            transition: transform 0.3s ease;
        }
        .tab-active {
            border-bottom: 3px solid #0077c2; /* ä¸»é¡Œè—è‰² */
            color: #0077c2;
            font-weight: 600;
        }
        /* å°éŠè·è²¬ï¼šäº®è‰²æ¨™ç±¤ */
        .tag-must-eat { background-color: #fca5a5; color: #7f1d1d; } /* å¿…åƒç¾é£Ÿ: æŸ”å’Œç´… */
        .tag-must-buy { background-color: #fde68a; color: #854d0e; } /* å¿…è²·ä¼´æ‰‹ç¦®: æŸ”å’Œé»ƒ */
        .tag-must-order { background-color: #a7f3d0; color: #065f46; } /* å¿…é»èœå–®: æŸ”å’Œç¶  */
        .tag-code { background-color: #bfdbfe; color: #1e40af; } /* é ç´„ä»£è™Ÿ: æŸ”å’Œè— */
        /* å°ˆé–€ç‚ºè‡ªé§•å°èˆªæŒ‰éˆ•è¨­è¨ˆçš„æ¥µç°¡é¢¨æ ¼ */
        .nav-btn {
            background-color: #0077c2;
            color: white;
            transition: background-color 0.2s;
        }
        .nav-btn:hover { background-color: #005691; }
    </style>
</head>
<body>

<div class="app-shell">
    <!-- å›ºå®šé ‚éƒ¨ Header å’Œ Tab å°èˆª -->
    <header class="sticky top-0 bg-white shadow-md z-10 p-4">
        <h1 class="text-xl font-bold text-gray-800 text-center">æ²–ç¹©è‡ªé§•è¡Œç¨‹ (2/13 ~ 2/18)</h1>
        
        <!-- Tab å°èˆª -->
        <div class="flex justify-around border-b mt-3 text-gray-500 text-sm">
            <button class="py-3 px-2 flex-1 text-center tab-btn tab-active" data-tab="itinerary">
                æ¯æ—¥è¡Œç¨‹
            </button>
            <button class="py-3 px-2 flex-1 text-center tab-btn" data-tab="tools">
                å¯¦ç”¨å·¥å…·
            </button>
        </div>
    </header>

    <!-- ä¸»è¦å…§å®¹å€å¡Š -->
    <main class="p-4 pt-0">
        <!-- 1. è¡Œç¨‹ Tab å…§å®¹ -->
        <div id="itinerary" class="tab-content">
            <div id="itinerary-container" class="space-y-6">
                <!-- è¡Œç¨‹å¡ç‰‡å°‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>

        <!-- 2. å·¥å…· Tab å…§å®¹ -->
        <div id="tools" class="tab-content hidden">
            <div class="space-y-6">
                <!-- èˆªç­è³‡è¨Š -->
                <div class="card bg-gray-50 p-4 rounded-xl">
                    <h2 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">âœˆï¸ èˆªç­è³‡è¨Š</h2>
                    <div class="text-sm space-y-2">
                        <p><span class="font-medium">å»ç¨‹:</span> 2/13(äº”) [èˆªç­è™Ÿ] - [èµ·é£›æ™‚é–“] â†’ Naha (OKA)</p>
                        <p><span class="font-medium">å›ç¨‹:</span> 2/18(ä¸‰) [èˆªç­è™Ÿ] - [èµ·é£›æ™‚é–“] â†’ [æŠµé”æ™‚é–“]</p>
                        <p class="text-red-600 font-medium">è«‹å‹™å¿…åœ¨é‚„è»Šå¾Œé ç•™ 2 å°æ™‚åˆ°æ©Ÿå ´å ±åˆ°ã€‚</p>
                        <input type="text" placeholder="è¼¸å…¥æ‚¨çš„èˆªç­ä»£ç¢¼..." class="w-full p-2 border rounded-lg mt-2 text-gray-600">
                    </div>
                </div>

                <!-- ä½å®¿è³‡è¨Š -->
                <div class="card bg-gray-50 p-4 rounded-xl">
                    <h2 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">ğŸ¨ ä½å®¿è³‡è¨Š</h2>
                    <div class="text-sm space-y-2">
                        <p><span class="font-medium">2/13 (äº”):</span> é‚£éœ¸å¸‚å€é£¯åº— (è«‹å¡«å…¥)</p>
                        <p><span class="font-medium">2/14-16 (å…­-ä¸€):</span> Hotel Nikko (æˆ–ä¸­éƒ¨/åŒ—éƒ¨é£¯åº—)</p>
                        <p><span class="font-medium">2/17 (äºŒ):</span> åŒ—è°·æˆ–é‚£éœ¸å¸‚å€é£¯åº— (è«‹å¡«å…¥)</p>
                        <button onclick="copyToClipboard('è«‹ç¢ºèªä½å®¿åœ°å€')" class="mt-3 w-full nav-btn py-2 rounded-lg text-sm">è¤‡è£½æ‰€æœ‰ä½å®¿åœ°å€</button>
                    </div>
                </div>

                <!-- ç·Šæ€¥è¯çµ¡é›»è©± -->
                <div class="card bg-gray-50 p-4 rounded-xl">
                    <h2 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">ğŸ“ ç·Šæ€¥è¯çµ¡é›»è©±</h2>
                    <div class="text-sm space-y-2">
                        <p><span class="font-medium">å°ç£é§æ—¥ä»£è¡¨è™• (é‚£éœ¸):</span> <a href="tel:+81-98-892-6020" class="text-blue-600 hover:underline">+81-98-892-6020</a></p>
                        <p><span class="font-medium">æ—¥æœ¬ç·Šæ€¥é›»è©±:</span> è­¦å¯Ÿ: 110 / æ•‘è­·è»Š/æ¶ˆé˜²: 119</p>
                        <p><span class="font-medium">ç§Ÿè»Šå…¬å¸é›»è©±:</span> <span class="text-green-600">è«‹å‹™å¿…å¡«å…¥!</span></p>
                    </div>
                </div>
                
                <!-- è¨˜å¸³/é ç®—è¡¨ (ç°¡æ˜“ç‰ˆ) -->
                <div class="card bg-gray-50 p-4 rounded-xl">
                    <h2 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">ğŸ’° è¨˜å¸³/é ç®—è¡¨ (ç¸½è¦½)</h2>
                    <div class="text-sm space-y-2">
                        <div class="flex justify-between">
                            <span class="font-medium">å·²èŠ±è²»:</span>
                            <span id="total-spent" class="font-bold text-red-600">Â¥ 0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium">å‰©é¤˜é ç®—:</span>
                            <span id="remaining-budget" class="font-bold text-green-600">Â¥ 0</span>
                        </div>
                        
                        <input type="number" id="budget-input" placeholder="è¨­å®šç¸½é ç®— (æ—¥å¹£)" class="w-full p-2 border rounded-lg mt-4 text-gray-600">
                        <div class="flex space-x-2 mt-2">
                            <input type="text" id="expense-desc" placeholder="é …ç›®æè¿° (å¦‚: åˆé¤)" class="flex-1 p-2 border rounded-lg text-gray-600">
                            <input type="number" id="expense-amount" placeholder="é‡‘é¡ (æ—¥å¹£)" class="w-1/3 p-2 border rounded-lg text-gray-600">
                            <button onclick="addExpense()" class="bg-indigo-500 hover:bg-indigo-600 text-white p-2 rounded-lg text-xs font-semibold">è¨˜å¸³</button>
                        </div>

                        <ul id="expense-list" class="mt-4 border-t pt-3 space-y-1 max-h-40 overflow-y-auto">
                            <!-- è¨˜å¸³ç´€éŒ„å°‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- åº•éƒ¨ç‰ˆæ¬Šä½”ä½ï¼Œå¢å¼· APP è¦–è¦ºæ„Ÿ -->
    <footer class="text-center text-xs text-gray-400 p-2 border-t mt-4">
        Okinawa Trip Planner - 2024
    </footer>

</div>

<script>
    // ============== è³‡æ–™å€å¡Š (è¡Œç¨‹å…§å®¹) ==============
    const tripData = [
        {
            date: "2/13(äº”)", dayName: "æŠµé”æ—¥ (å—éƒ¨)", weatherLocation: "é‚£éœ¸",
            attractions: [
                { name: "é‚£éœ¸æ©Ÿå ´ (Naha Airport)", notes: "æŠµé” & è¾¦ç†æ‰‹çºŒ" },
                { name: "ç§Ÿè»Šå…¬å¸", notes: "å–è»Š (é è¨ˆ20åˆ†é˜)" },
                { name: "åœ‹éš›é€š (Kokusai Street)", notes: "ä¸‹åˆé€›è¡—, æ™šä¸Šå°åƒ (é è¨ˆ15åˆ†é˜è»Šç¨‹)" },
                { name: "é£¯åº— (é‚£éœ¸å¸‚å€)", notes: "Check-in (ç´„1å°æ™‚è»Šç¨‹)" },
            ],
            restaurants: [
                { type: "åˆé¤ (éš¨é¸)", name: "èŠ±ç¬ é£Ÿå ‚ / å¤§æ±å£½å¸ / è±¬è‚‰è›‹é£¯ç³° (åœ‹éš›é€šé™„è¿‘)" },
                { type: "æ™šé¤ (éš¨èˆˆ)", name: "åœ‹éš›é€šéš¨èˆˆå°åƒ" },
            ],
            guide: {
                title: "ã€è‡ªé§•æ”»ç•¥ã€‘é‚£éœ¸å¸‚å€",
                tips: "æŠµé”é‚£éœ¸æ©Ÿå ´å¾Œè«‹ç•™æ„ç§Ÿè»Šå…¬å¸çš„æ¥é§è»ŠæŒ‡ç¤ºç‰Œã€‚åœ‹éš›é€šå‘¨é‚Šåœè»Šä½è¼ƒå°‘ä¸”è²´ï¼Œå»ºè­°å…ˆå°‡è¡Œææ”¾åœ¨é£¯åº—å†å¾’æ­¥å‰å¾€ã€‚",
                highlights: [
                    { key: "å¿…åƒç¾é£Ÿ", value: "èŠ±ç¬ é£Ÿå ‚ã€è±¬è‚‰è›‹é£¯ç³°ã€Blue Sealå†°æ·‡æ·‹" },
                    { key: "å¿…è²·ä¼´æ‰‹ç¦®", value: "å¾¡è“å­å¾¡æ®¿ç´…èŠ‹å¡”ã€é›ªé¹½å•†å“" },
                ],
            },
            accommodation: "é‚£éœ¸å¸‚å€é£¯åº— (å¾…ç¢ºèª)",
        },
        {
            date: "2/14(å…­)", dayName: "ç‰çƒæ–‡åŒ– & å—éƒ¨æµ·å³¶", weatherLocation: "å—åŸ / ç€¨é•·å³¶",
            attractions: [
                { name: "æ²–ç¹©ä¸–ç•Œæ–‡åŒ–ç‹åœ‹ (ç‰æ³‰æ´)", notes: "åœç•™2hr, é˜ä¹³çŸ³æ´èˆ‡ç‹åœ‹æ‘" },
                { name: "ç‰æŸ“çŠç‘šæ‹“å°", notes: "é«”é©—æ´»å‹• (1hr)" },
                { name: "ç€¨é•·å³¶ (Senaga Island)", notes: "ä¸‹åˆèŒ¶ã€çœ‹é£›æ©Ÿèµ·é™åŠæ—¥è½" },
            ],
            restaurants: [
                { type: "åˆé¤", name: "å±±å†…é£Ÿå ‚ (å—åŸ) - å¿…åƒè±¬è…³éºµ (ç´„10åˆ†é˜è»Šç¨‹)" },
                { type: "æ™šé¤ (éš¨é¸)", name: "ç€¨é•·å³¶47éƒ½é“åºœç¸£é¤å»³ æˆ– èŠ±ç¹”ãã° (å›é£¯åº—æ–¹å‘)" },
            ],
            guide: {
                title: "ã€ç‰æ³‰æ´ & ç€¨é•·å³¶æ”»ç•¥ã€‘",
                tips: "æ²–ç¹©ä¸–ç•Œæ–‡åŒ–ç‹åœ‹çš„å¤ªé¼“ç§€ï¼ˆEisa Drum Showï¼‰é€šå¸¸åœ¨ä¸‹åˆæœ‰å ´æ¬¡ï¼Œè«‹æå‰ç¢ºèªæ™‚é–“ï¼Œå¼·çƒˆæ¨è–¦è§€è³ï¼ç‰æ³‰æ´å…§è¼ƒæ¿•æ»‘ï¼Œè«‹ç©¿è‘—é˜²æ»‘é‹ã€‚ç€¨é•·å³¶çš„ã€å¹¸ç¦é¬†é¤…ã€æ˜¯äººæ°£ä¸‹åˆèŒ¶ã€‚",
                highlights: [
                    { key: "å¿…åƒç¾é£Ÿ", value: "å±±å†…é£Ÿå ‚ï¼ˆè±¬è…³éºµï¼‰ã€ç€¨é•·å³¶å¹¸ç¦é¬†é¤…ã€ç‰æ³‰æ´å…§ Nantoå±‹æ²–ç¹©éºµ" },
                    { key: "å¿…è²·ä¼´æ‰‹ç¦®", value: "ç‰æŸ“çŠç‘šæ‹“å°çš„ç¨å®¶ç´€å¿µå“" },
                    { key: "é‡è¦é ç´„ä»£è™Ÿ", value: "ç‰æŸ“æ‹“å°: RYSN1400 / å¤ªé¼“ç§€æ™‚æ®µ: 14:30" },
                ],
            },
            accommodation: "Hotel Nikko (ä¸­éƒ¨/æ©ç´)",
        },
        {
            date: "2/15(æ—¥)", dayName: "åŒ—éƒ¨ç¾æ™¯ & æµ·æ´‹æ¢éšª", weatherLocation: "åè­· / æ©ç´",
            attractions: [
                { name: "åè­·é³³æ¢¨åœ’", notes: "ç´„1hrè»Šç¨‹ï¼Œåœç•™1.5hr" },
                { name: "Panza Zipline (æ»‘ç´¢)", notes: "é«”é©— (2hr, éœ€é ç´„)" },
                { name: "é’ä¹‹æ´çªŸæµ®æ½›", notes: "æ©ç´æ‘ï¼Œ2~3hr (éœ€é ç´„)" },
            ],
            restaurants: [
                { type: "åˆé¤ (æ¥µæ¨)", name: "ç™¾å¹´å¤å®¶ å¤§å®¶ (åè­·) - å¿…åƒé˜¿å¤è±¬ (ç´„15åˆ†é˜è»Šç¨‹)" },
                { type: "æ™šé¤ (éš¨é¸)", name: "ç‰çƒã®ç‰› (éœ€é ç´„) / æµœå±‹ãã° (åŒ—è°·)" },
            ],
            guide: {
                title: "ã€åè­· & æ©ç´æ”»ç•¥ã€‘",
                tips: "é’ä¹‹æ´çªŸæµ®æ½›å—å¤©æ°£å½±éŸ¿å¤§ï¼Œè«‹å‹™å¿…æå‰é ç´„ä¸¦ç¢ºèªç•¶æ—¥æµ·æ³ã€‚é³³æ¢¨åœ’çš„é³³æ¢¨è»Šå¾ˆæœ‰è¶£ï¼Œå¯ä»¥è©¦è©¦ã€‚å¤§å®¶(Ufuya)é¤å»³æœ€å¥½é ç´„æ™šé¤æ™‚æ®µï¼Œæ°£æ°›æ¥µä½³ã€‚",
                highlights: [
                    { key: "å¿…åƒç¾é£Ÿ", value: "ç™¾å¹´å¤å®¶å¤§å®¶ (é˜¿å¤è±¬æ¶®æ¶®é‹)ã€ç‰çƒã®ç‰› (é ‚ç´šç‡’è‚‰)ã€æµœå±‹ãã°" },
                    { key: "å¿…é»èœå–®", value: "å¤§å®¶é¤å»³ï¼šæ¥µä¸Šç‰¹é¸é˜¿å¤è±¬æ¶®æ¶®é‹ã€ç‰¹è£½æ³¡èŠ™" },
                    { key: "é‡è¦é ç´„ä»£è™Ÿ", value: "é’ä¹‹æ´çªŸæµ®æ½›: GDV-2025 / ç‰çƒã®ç‰›é ç´„: LQN0215" },
                ],
            },
            accommodation: "Hotel Nikko (ä¸­éƒ¨/æ©ç´)",
        },
        {
            date: "2/16(ä¸€)", dayName: "ä¸­éƒ¨å‹•æ…‹é«”é©—", weatherLocation: "å®œé‡ç£ / é‡‘æ­¦ç”º",
            attractions: [
                { name: "å®œé‡ç£æ»‘ç¿”å‚˜", notes: "é«”é©— 1.5hr (éœ€é ç´„)" },
                { name: "é‡‘æ­¦ç”º ç´…æ¨¹æ—ç¨æœ¨èˆŸ+é‡£é­š", notes: "é«”é©— 3hr (éœ€é ç´„)" },
            ],
            restaurants: [
                { type: "åˆé¤", name: "ä¸­æ‘å®¶ (å®œé‡ç£) (ç´„15åˆ†é˜è»Šç¨‹)" },
                { type: "æ™šé¤ (éš¨é¸)", name: "å³¶ã‚„ã•ã„é£Ÿå ‚ã¦ã„ä¸€ã‚ã‚“ã  / èŠ±ç¹”ãã° (ç´„10-20åˆ†é˜è»Šç¨‹)" },
            ],
            guide: {
                title: "ã€å®œé‡ç£ & é‡‘æ­¦ç”ºæ”»ç•¥ã€‘",
                tips: "æ»‘ç¿”å‚˜å’Œç¨æœ¨èˆŸéƒ½æ˜¯æˆ¶å¤–æ´»å‹•ï¼Œéœ€ç©¿è‘—è¼•ä¾¿è¡£ç‰©ï¼Œä¸¦æ³¨æ„é˜²æ›¬ã€‚ç¨æœ¨èˆŸé«”é©—è«‹è¨˜å¾—æ”œå¸¶é˜²æ°´è¢‹ä¿è­·æ‰‹æ©Ÿã€‚",
                highlights: [
                    { key: "å¿…åƒç¾é£Ÿ", value: "ä¸­æ‘å®¶ (æ²–ç¹©éºµ)ã€é‡‘æ­¦ç”ºå¡”å¯é£¯ (Taco Rice)" },
                    { key: "å¿…è²·ä¼´æ‰‹ç¦®", value: "ç´…æ¨¹æ—é«”é©—è™•å¯èƒ½æœ‰ç•¶åœ°ç‰¹è‰²æ‰‹å·¥è—å“" },
                    { key: "é‡è¦é ç´„ä»£è™Ÿ", value: "æ»‘ç¿”å‚˜: PSC-0216 / ç¨æœ¨èˆŸ: KMC-M0930" },
                ],
            },
            accommodation: "Hotel Nikko (ä¸­éƒ¨/æ©ç´)",
        },
        {
            date: "2/17(äºŒ)", dayName: "åŒ—è°·/é‚£éœ¸è½‰ç§» & è³¼ç‰©", weatherLocation: "å®œé‡åº§ / åŒ—è°·",
            attractions: [
                { name: "è¶Šé‡è»Šé«”é©— (PANZA å®œé‡åº§ç­‰)", notes: "é«”é©— 1.5hr (éœ€é ç´„)" },
                { name: "ç›´å‡æ©Ÿå·¡éŠ", notes: "é‚£éœ¸/åŒ—è°· (éœ€é ç´„ï¼Œ30-60åˆ†é˜)" },
                { name: "åŒ—è°·ç¾åœ‹æ‘ (American Village)", notes: "æ™šä¸Šé€›è¡—" },
            ],
            restaurants: [
                { type: "åˆé¤", name: "é“ã®é§…è¨±ç”° (è¨±ç”°ä¼‘æ¯ç«™) (ç´„20åˆ†é˜è»Šç¨‹)" },
                { type: "æ™šé¤ (éš¨é¸)", name: "åŒ—è°·ç¾åœ‹æ‘: Gordie's / A&W (ç¾å¼æ¼¢å ¡) æˆ– é‚£éœ¸: æ³¢å¸ƒé£Ÿå ‚ (ä»½é‡é©šäºº)" },
            ],
            guide: {
                title: "ã€ç¾åœ‹æ‘ & è³¼ç‰©æ”»ç•¥ã€‘",
                tips: "ç¾åœ‹æ‘çš„æ—¥è½æµ·ç˜æ™¯è‰²éå¸¸ç¾ï¼Œæ¨è–¦å‚æ™šå‰å¾€ã€‚æ³¢å¸ƒé£Ÿå ‚ä»¥å…¶å·¨ç„¡éœ¸ä»½é‡èåï¼ŒæŒ‘æˆ°å‰è«‹ä¸‰æ€ï¼",
                highlights: [
                    { key: "å¿…åƒç¾é£Ÿ", value: "Gordie's (ç¾å¼æ¼¢å ¡)ã€A&W (ç¾å¼é€Ÿé£Ÿ)ã€æ³¢å¸ƒé£Ÿå ‚ (å·¨ç„¡éœ¸é¤é»)" },
                    { key: "å¿…è²·ä¼´æ‰‹ç¦®", value: "ç¾åœ‹æ‘å…§çš„ç¾è»ç´€å¿µå“ã€ç‰¹è‰²æœé£¾" },
                    { key: "é‡è¦é ç´„ä»£è™Ÿ", value: "ç›´å‡æ©Ÿå·¡éŠ: HELI-0217" },
                ],
            },
            accommodation: "åŒ—è°·æˆ–é‚£éœ¸å¸‚å€é£¯åº—",
        },
        {
            date: "2/18(ä¸‰)", dayName: "è³¼ç‰© & è³¦æ­¸", weatherLocation: "é‚£éœ¸",
            attractions: [
                { name: "é‚£éœ¸å¸‚å€è³¼ç‰©", notes: "åœ‹éš›é€š/DFS (1hr)" },
                { name: "ç§Ÿè»Šå…¬å¸", notes: "é‚„è»Š (é è¨ˆ20åˆ†é˜)" },
                { name: "é‚£éœ¸æ©Ÿå ´", notes: "æ­æ©Ÿè¿”å®¶" },
            ],
            restaurants: [],
            guide: {
                title: "ã€æœ€å¾Œè¡åˆºè³¼ç‰© & é‚„è»Šã€‘",
                tips: "DFS T Galleriaå…ç¨…åº—åœ¨åœ‹éš›é€šé™„è¿‘ï¼Œå»ºè­°å…ˆé€›å†é‚„è»Šã€‚é‚„è»Šå‰è«‹å‹™å¿…å°‡æ²¹ç®±åŠ æ»¿ï¼Œä¸¦é ç•™å……è¶³æ™‚é–“è¾¦ç†é‚„è»Šæ‰‹çºŒåŠå‰å¾€æ©Ÿå ´ã€‚",
                highlights: [
                    { key: "å¿…è²·ä¼´æ‰‹ç¦®", value: "DFSå…ç¨…ç²¾å“ã€åœ‹éš›é€šç‰¹è‰²é…’é¡ï¼ˆæ³¡ç››ï¼‰ã€æ²–ç¹©é»‘ç³–" },
                ],
            },
            accommodation: "å®¶",
        },
    ];

    // ============== æ ¸å¿ƒ JS é‚è¼¯ ==============

    // 1. Tab åˆ‡æ›åŠŸèƒ½
    document.querySelectorAll('.tab-btn').forEach(button => {
        button.addEventListener('click', function() {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('tab-active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

            this.classList.add('tab-active');
            document.getElementById(this.dataset.tab).classList.remove('hidden');
        });
    });

    // 2. å°èˆªé€£çµç”Ÿæˆå™¨ (Google Maps)
    function generateNavigationLink(locationName) {
        // ä½¿ç”¨ URL ç·¨ç¢¼ç¢ºä¿åœ°å€æ­£ç¢ºå‚³éçµ¦ Google Maps
        const encodedName = encodeURIComponent(locationName + " æ²–ç¹©");
        return `https://www.google.com/maps/search/?api=1&query=${encodedName}`;
    }

    // 3. äº®é»æ¨™ç±¤ç”Ÿæˆå™¨
    function getTagClass(key) {
        switch (key) {
            case "å¿…åƒç¾é£Ÿ": return "tag-must-eat";
            case "å¿…è²·ä¼´æ‰‹ç¦®": return "tag-must-buy";
            case "å¿…é»èœå–®": return "tag-must-order";
            case "é‡è¦é ç´„ä»£è™Ÿ": return "tag-code";
            default: return "bg-gray-200 text-gray-700";
        }
    }
    
    // 4. è¡Œç¨‹å¡ç‰‡ç”Ÿæˆ
    function renderItinerary() {
        const container = document.getElementById('itinerary-container');
        container.innerHTML = tripData.map(day => `
            <!-- æ¯æ—¥è¡Œç¨‹å¡ç‰‡ -->
            <div class="card bg-white p-4 rounded-xl shadow-lg">
                <h2 class="text-xl font-extrabold text-[#005691] border-b-2 border-dashed border-gray-100 pb-2 mb-3">
                    ${day.date} (${day.dayName})
                </h2>

                <!-- æ¨¡æ“¬å¤©æ°£é å ±å¡ç‰‡ (å³æ™‚å¤©æ°£éœ€è¦ API æ”¯æ´ï¼Œæ­¤è™•ç‚º UI ä½”ä½) -->
                <div class="flex items-center justify-between p-3 mb-4 rounded-lg bg-indigo-50/70 border border-indigo-100">
                    <div class="flex items-center space-x-2">
                        <!-- å‡å®šå¤©æ°£åœ–ç¤º (ä½¿ç”¨ emoji æ¨¡æ“¬) -->
                        <span class="text-3xl">ğŸŒ¤ï¸</span>
                        <div>
                            <p class="text-xs text-gray-500">å³æ™‚å¤©æ°£ (åœ°é»: ${day.weatherLocation})</p>
                            <p class="font-bold text-gray-800">18Â°C ~ 22Â°C (å¤šé›²å¶æ™´)</p>
                        </div>
                    </div>
                    <span class="text-xs text-indigo-600 font-medium">æ›´æ–°æ™‚é–“: 11:00 AM</span>
                </div>

                <!-- æ™¯é»/äº¤é€šå¡ç‰‡ -->
                <div class="space-y-4">
                    <h3 class="text-base font-semibold text-gray-700 mb-2 border-l-4 border-yellow-500 pl-2">ğŸ“ æ™¯é» / é«”é©— (Attractions)</h3>
                    ${day.attractions.map(item => `
                        <div class="flex justify-between items-center text-sm border-b pb-2">
                            <div>
                                <p class="font-medium text-gray-800">${item.name}</p>
                                <p class="text-xs text-gray-500">${item.notes}</p>
                            </div>
                            <!-- å°èˆªæŒ‰éˆ• -->
                            <a href="${generateNavigationLink(item.name)}" target="_blank" class="nav-btn flex items-center px-3 py-1 text-xs rounded-full shadow-md whitespace-nowrap">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.243-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                å°èˆª
                            </a>
                        </div>
                    `).join('')}
                </div>

                <!-- é¤å»³/åˆæ™šé¤å¡ç‰‡ -->
                <div class="mt-6 space-y-4">
                    <h3 class="text-base font-semibold text-gray-700 mb-2 border-l-4 border-green-500 pl-2">ğŸœ é¤å»³ / ç¾é£Ÿ (Dining)</h3>
                    ${day.restaurants.map(item => `
                        <div class="flex justify-between items-center text-sm border-b pb-2">
                            <div>
                                <p class="font-medium text-gray-800">${item.name}</p>
                                <p class="text-xs text-gray-500 italic">${item.type}</p>
                            </div>
                            <a href="${generateNavigationLink(item.name)}" target="_blank" class="nav-btn flex items-center px-3 py-1 text-xs rounded-full shadow-md whitespace-nowrap">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.243-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                å°èˆª
                            </a>
                        </div>
                    `).join('')}
                </div>
                
                <!-- å°éŠè·è²¬/æ”»ç•¥å¡ç‰‡ (ç‰¹åˆ¥åˆ†æèˆ‡äº®é»æ¨™è¨») -->
                <div class="mt-6 border-t pt-4">
                    <h3 class="text-base font-semibold text-gray-700 mb-3 border-l-4 border-red-500 pl-2">ğŸ’¡ å°éŠåˆ†æèˆ‡æ”»ç•¥</h3>
                    <p class="text-xs text-gray-600 italic mb-3">${day.guide.tips}</p>
                    <div class="flex flex-wrap gap-2">
                        ${day.guide.highlights.map(h => `
                            <span class="text-xs font-bold px-3 py-1 rounded-full ${getTagClass(h.key)}">
                                ${h.key}: ${h.value}
                            </span>
                        `).join('')}
                    </div>
                </div>

                <!-- ä½å®¿åœ°é» -->
                <div class="mt-4 pt-3 border-t">
                    <p class="text-sm font-medium text-gray-600">ğŸ  ç•¶æ™šä½å®¿: <span class="text-gray-800">${day.accommodation}</span></p>
                </div>
            </div>
        `).join('');
    }

    // 5. è¨˜å¸³/é ç®—åŠŸèƒ½
    let budget = 0;
    let expenses = [];
    
    function updateBudgetDisplay() {
        const totalSpent = expenses.reduce((sum, item) => sum + item.amount, 0);
        const remaining = budget - totalSpent;
        document.getElementById('total-spent').textContent = `Â¥ ${totalSpent.toLocaleString()}`;
        document.getElementById('remaining-budget').textContent = `Â¥ ${remaining.toLocaleString()}`;
        document.getElementById('remaining-budget').classList.toggle('text-red-600', remaining < 0);
        document.getElementById('remaining-budget').classList.toggle('text-green-600', remaining >= 0);
    }

    document.getElementById('budget-input').addEventListener('input', (e) => {
        budget = parseInt(e.target.value) || 0;
        updateBudgetDisplay();
    });

    function addExpense() {
        const desc = document.getElementById('expense-desc').value.trim();
        const amount = parseInt(document.getElementById('expense-amount').value);

        if (desc && amount > 0) {
            expenses.push({ desc, amount, id: Date.now() });
            
            // æ¸…ç©ºè¼¸å…¥
            document.getElementById('expense-desc').value = '';
            document.getElementById('expense-amount').value = '';

            // æ›´æ–°åˆ—è¡¨
            renderExpenseList();
            updateBudgetDisplay();
        }
    }

    function renderExpenseList() {
        const list = document.getElementById('expense-list');
        list.innerHTML = expenses.map(item => `
            <li class="flex justify-between text-xs text-gray-700 border-b border-gray-100 py-1">
                <span>${item.desc}</span>
                <span class="font-semibold text-red-500">- Â¥ ${item.amount.toLocaleString()}</span>
            </li>
        `).join('');
    }

    // 6. è¼”åŠ©å·¥å…·ï¼šè¤‡è£½åˆ°å‰ªè²¼æ¿
    function copyToClipboard(text) {
        // ä½¿ç”¨ document.execCommand('copy') ä½œç‚º iframe ç’°å¢ƒä¸‹çš„å…¼å®¹æ–¹æ¡ˆ
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed'; // é˜²æ­¢æ»¾å‹•
        document.body.appendChild(textarea);
        textarea.focus();
        textarea.select();
        try {
            document.execCommand('copy');
            // é€™è£¡æˆ‘å€‘ç”¨ç°¡å–®çš„ UI æç¤ºå–ä»£ alert()
            const msg = document.createElement('div');
            msg.textContent = 'å·²è¤‡è£½åˆ°å‰ªè²¼æ¿!';
            msg.className = 'fixed top-4 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-xl text-sm z-50 transition-opacity duration-300';
            document.body.appendChild(msg);
            setTimeout(() => {
                msg.remove();
            }, 1500);
        } catch (err) {
            console.error('ç„¡æ³•è¤‡è£½', err);
        }
        document.body.removeChild(textarea);
    }
    
    // å°‡ copyToClipboard å‡½æ•¸æš´éœ²åˆ° window ä¾› HTML èª¿ç”¨
    window.copyToClipboard = copyToClipboard;
    window.addExpense = addExpense;


    // 7. æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
        renderItinerary();
        updateBudgetDisplay(); // åˆå§‹åŒ–é ç®—é¡¯ç¤º

        // PWA è¨»å†Š Service Worker
        if ('serviceWorker' in navigator) {
            // ç¢ºä¿è·¯å¾‘æ˜¯æ­£ç¢ºçš„ã€‚å¦‚æœ service-worker.js åœ¨æ ¹ç›®éŒ„ï¼Œä½¿ç”¨ /service-worker.js
            // åœ¨ GitHub Pages çš„å­ç›®éŒ„ç’°å¢ƒä¸‹ï¼Œä½¿ç”¨ './service-worker.js' é€šå¸¸æ›´å®‰å…¨
            navigator.serviceWorker.register('./service-worker.js')
                .then(reg => console.log('Service Worker è¨»å†ŠæˆåŠŸ:', reg.scope))
                .catch(err => console.error('Service Worker è¨»å†Šå¤±æ•—:', err));
        }
    });

</script>
</body>
</html>